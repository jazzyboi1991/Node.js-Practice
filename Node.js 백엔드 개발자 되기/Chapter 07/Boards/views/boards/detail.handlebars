<div class="row">
    <div class="col-md-8 mx-auto">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h2 class="card-title mb-0">{{board.title}}</h2>
                <div class="text-muted small">
                    조회수: {{board.views}}
                </div>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <span class="badge bg-secondary">작성자: {{board.author}}</span>
                    <span class="badge bg-light text-dark ms-2">작성일: {{formatDate board.createdAt}}</span>
                    {{#if board.updatedAt}}
                    <span class="badge bg-light text-dark ms-2">수정일: {{formatDate board.updatedAt}}</span>
                    {{/if}}
                </div>
                
                <div class="content mb-4">
                    {{{formatContent board.content}}}
                </div>

                {{#if board.attachments.length}}
                <div class="attachments">
                    <h6>첨부파일</h6>
                    <ul class="list-group">
                        {{#each board.attachments}}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span>{{this.originalName}}</span>
                            <a href="/uploads/{{this.filename}}" class="btn btn-sm btn-outline-primary" download="{{this.originalName}}">다운로드</a>
                        </li>
                        {{/each}}
                    </ul>
                </div>
                {{/if}}
            </div>
            <div class="card-footer">
                <div class="btn-group" role="group">
                    <a href="/" class="btn btn-secondary">목록</a>
                    <a href="/board/{{board._id}}/edit" class="btn btn-warning">수정</a>
                    <button type="button" class="btn btn-danger" onclick="deletePost('{{board._id}}')">삭제</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function deletePost(id) {
    if (confirm('정말로 삭제하시겠습니까?')) {
        fetch(`/api/boards/${id}`, {
            method: 'DELETE'
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('게시글이 삭제되었습니다.');
                location.href = '/';
            } else {
                alert('삭제 중 오류가 발생했습니다.');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('삭제 중 오류가 발생했습니다.');
        });
    }
}
</script>